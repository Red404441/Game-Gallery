<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>CJ Falons Ebook Readery</title>

<!-- =====================================================================
  PWA MANIFEST (inline for single-file deployment)
  To use: save this file as index.html in your repo root.
  Add a 192x192 and 512x512 icon.png to your repo for full PWA support.
====================================================================== -->
<link rel="manifest" href="manifest.json"/>
<link rel="icon" type="image/png" sizes="32x32" href="icon-192.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="icon-192.png"/>
<link rel="apple-touch-icon" href="icon-192.png"/>
<meta name="theme-color" content="#6ec6f5"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="default"/>
<meta name="description" content="A curated gallery of browser games â€” Frutiger Aero Edition"/>

<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@400;700;900&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet"/>

<style>
/* ======================================================================
   DESIGN TOKENS â€” edit these to retheme the entire site
   ====================================================================== */
:root {
  /* Sky palette */
  --sky-top: #6ec6f5;
  --sky-mid: #b8e0f7;
  --sky-low: #dff2fd;

  /* Glass */
  --glass-bg:     rgba(255,255,255,0.62);
  --glass-border: rgba(255,255,255,0.78);
  --glass-shadow: rgba(0,60,120,0.10);

  /* Accent */
  --accent:      #0e7fcc;
  --accent-2:    #46c4e3;
  --accent-glow: rgba(14,127,204,0.22);

  /* Text */
  --text:      #042a3c;
  --text-mid:  #185470;
  --text-soft: #3a7a99;

  /* Semantic */
  --danger:  #c0392b;
  --success: #0a9e6e;
  --warning: #d4870a;

  /* Favourites star */
  --star-active: #f5a623;

  /* Shape */
  --radius-lg: 18px;
  --radius-md: 12px;
  --radius-sm:  8px;

  /* Typography */
  --font-display: 'Unbounded', sans-serif;
  --font-body:    'DM Sans', sans-serif;

  /* Motion */
  --ease: .28s cubic-bezier(.2,.9,.3,1);

  /* Layout */
  --grid-min: 200px;   /* min tile width â€” increase for larger tiles */
  --grid-gap:  12px;
}

/* â”€â”€ Dark theme overrides â”€â”€ */
[data-theme="dark"] {
  --sky-top: #0a1628;
  --sky-mid: #0d1f38;
  --sky-low: #0f2440;
  --glass-bg:     rgba(12,28,52,0.72);
  --glass-border: rgba(255,255,255,0.08);
  --glass-shadow: rgba(0,0,0,0.30);
  --text:      #d8eeff;
  --text-mid:  #7ec4e8;
  --text-soft: #4a8aaa;
  --accent:    #38aee8;
  --accent-2:  #56d4f5;
  --accent-glow: rgba(56,174,232,0.22);
}

/* â”€â”€ Compact view â”€â”€ */
[data-compact="true"] { --grid-min: 150px; --grid-gap: 8px; }

*,*::before,*::after { box-sizing: border-box; margin: 0; padding: 0; }

html, body {
  min-height: 100%;
  font-family: var(--font-body);
  color: var(--text);
  -webkit-font-smoothing: antialiased;
  overflow-x: hidden;
  transition: color .3s, background .3s;
}

body {
  background:
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E"),
    linear-gradient(175deg, var(--sky-top) 0%, var(--sky-mid) 40%, var(--sky-low) 75%, #f0faff 100%);
  background-attachment: fixed;
  padding: 20px 16px 48px;
}

[data-theme="dark"] body {
  background:
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.06'/%3E%3C/svg%3E"),
    linear-gradient(175deg, #071422 0%, #0a1a30 40%, #0d2040 100%);
  background-attachment: fixed;
}

/* Decorative blobs */
body::before, body::after {
  content: ''; position: fixed; border-radius: 50%; pointer-events: none; z-index: 0;
}
body::before {
  width: 640px; height: 640px;
  background: radial-gradient(circle, rgba(110,198,245,0.22), transparent 65%);
  top: -160px; right: -160px;
}
body::after {
  width: 480px; height: 480px;
  background: radial-gradient(circle, rgba(70,196,227,0.14), transparent 65%);
  bottom: -120px; left: -120px;
}

/* ======================================================================
   SEASONAL THEMES
   Applied automatically by JS based on current month.
   To manually override: set data-season="spring|summer|autumn|winter" on <html>
   ====================================================================== */
[data-season="spring"] { --sky-top:#a8e6cf; --sky-mid:#c8f5e0; --sky-low:#e8fff5; }
[data-season="spring"][data-theme="dark"] { --sky-top:#0a1f14; --sky-mid:#0d2a1a; --sky-low:#0f3020; }
/* summer = default Aero blue, no override needed */
[data-season="autumn"] {
  --sky-top:#e8a87c; --sky-mid:#f2c99a; --sky-low:#fdecd8;
  --accent:#c0622a; --accent-2:#e8903a; --accent-glow:rgba(192,98,42,0.22);
}
[data-season="autumn"][data-theme="dark"] { --sky-top:#1a0e06; --sky-mid:#261408; --sky-low:#301a0a; }
[data-season="winter"] {
  --sky-top:#b8d4f0; --sky-mid:#d8eaf8; --sky-low:#eef5fd;
  --accent:#3a7abf; --accent-2:#6ab0e8; --accent-glow:rgba(58,122,191,0.22);
}
[data-season="winter"][data-theme="dark"] { --sky-top:#080e1a; --sky-mid:#0c1428; --sky-low:#101a30; }

/* Snowflakes */
.snowflakes { position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden;display:none; }
[data-season="winter"] .snowflakes { display:block; }
.snowflake { position:absolute;top:-20px;color:rgba(255,255,255,0.78);font-size:1em;animation:snowfall linear infinite;user-select:none;pointer-events:none; }
[data-theme="dark"] .snowflake { color:rgba(160,200,240,0.38); }
@keyframes snowfall { 0%{transform:translateY(-20px) rotate(0deg);opacity:1;} 100%{transform:translateY(110vh) rotate(360deg);opacity:0.1;} }

/* Autumn leaves */
.leaves { position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden;display:none; }
[data-season="autumn"] .leaves { display:block; }
.leaf { position:absolute;top:-30px;animation:leaffall linear infinite;user-select:none;pointer-events:none;font-size:1.2em; }
@keyframes leaffall { 0%{transform:translateY(-30px) rotate(0deg) translateX(0);opacity:1;} 50%{transform:translateY(50vh) rotate(180deg) translateX(40px);} 100%{transform:translateY(110vh) rotate(360deg) translateX(-20px);opacity:0.1;} }

/* Spring blossoms */
.blossoms { position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden;display:none; }
[data-season="spring"] .blossoms { display:block; }
.blossom { position:absolute;top:-20px;animation:blossomfall linear infinite;user-select:none;pointer-events:none;font-size:0.9em; }
@keyframes blossomfall { 0%{transform:translateY(-20px) rotate(0deg);opacity:1;} 100%{transform:translateY(110vh) rotate(720deg);opacity:0.1;} }

@media (prefers-reduced-motion:reduce) { .snowflake,.leaf,.blossom { animation:none;display:none; } }

/* Seasonal indicator pill in header tagline */
.season-pill {
  display:inline-flex;align-items:center;gap:5px;
  background:rgba(255,255,255,0.5);border:1px solid var(--glass-border);
  border-radius:100px;padding:2px 9px;font-size:11px;color:var(--text-soft);
  backdrop-filter:blur(6px);vertical-align:middle;margin-left:6px;
}
[data-theme="dark"] .season-pill { background:rgba(20,40,80,0.5); }

/* ======================================================================
   CUSTOM CURSOR
   ====================================================================== */
body,input,select,button,a,[role="button"] { cursor:none; }
/* Fallback for touch devices */
@media (hover:none) {
  body,input,select,button,a,[role="button"] { cursor:auto; }
  .cursor-dot,.cursor-ring { display:none !important; }
}

.cursor-dot {
  position:fixed;z-index:99999;pointer-events:none;
  width:9px;height:9px;border-radius:50%;
  background:var(--accent);
  transform:translate(-50%,-50%);
  transition:width .12s,height .12s,background .15s;
  will-change:left,top;
}
.cursor-ring {
  position:fixed;z-index:99998;pointer-events:none;
  width:34px;height:34px;border-radius:50%;
  border:1.5px solid rgba(14,127,204,0.42);
  transform:translate(-50%,-50%);
  transition:width .24s cubic-bezier(.2,.9,.3,1),height .24s cubic-bezier(.2,.9,.3,1),border-color .2s,background .2s;
  will-change:left,top;
}
[data-theme="dark"] .cursor-ring { border-color:rgba(56,174,232,0.5); }
body.cursor-hover .cursor-dot  { width:5px;height:5px;background:white; }
body.cursor-hover .cursor-ring { width:44px;height:44px;border-color:rgba(14,127,204,0.65);background:rgba(14,127,204,0.07); }
body.cursor-click .cursor-dot  { width:13px;height:13px;background:var(--accent-2); }
body.cursor-click .cursor-ring { width:26px;height:26px; }

/* â”€â”€ Animated clouds â”€â”€ */
.clouds { position: fixed; inset: 0; z-index: 0; pointer-events: none; overflow: hidden; }
.cloud {
  position: absolute;
  background: rgba(255,255,255,0.55);
  border-radius: 50px;
  animation: drift linear infinite;
}
[data-theme="dark"] .cloud { background: rgba(255,255,255,0.04); }
.cloud::before, .cloud::after {
  content: ''; position: absolute; background: inherit; border-radius: 50%;
}
.cloud:nth-child(1) { width:120px;height:40px; top:8%; animation-duration:80s; animation-delay:-20s; }
.cloud:nth-child(1)::before { width:60px;height:60px;top:-30px;left:15px; }
.cloud:nth-child(1)::after  { width:40px;height:40px;top:-18px;left:55px; }
.cloud:nth-child(2) { width:180px;height:55px; top:18%; animation-duration:110s; animation-delay:-50s; opacity:.7; }
.cloud:nth-child(2)::before { width:80px;height:80px;top:-40px;left:25px; }
.cloud:nth-child(2)::after  { width:55px;height:55px;top:-25px;left:80px; }
.cloud:nth-child(3) { width:90px;height:30px; top:32%; animation-duration:65s; animation-delay:-10s; opacity:.5; }
.cloud:nth-child(3)::before { width:50px;height:50px;top:-25px;left:10px; }
.cloud:nth-child(4) { width:140px;height:45px; top:5%; animation-duration:95s; animation-delay:-75s; opacity:.6; }
.cloud:nth-child(4)::before { width:70px;height:70px;top:-35px;left:20px; }
.cloud:nth-child(4)::after  { width:45px;height:45px;top:-20px;left:70px; }
@keyframes drift {
  from { transform: translateX(-250px); }
  to   { transform: translateX(calc(100vw + 250px)); }
}
@media (prefers-reduced-motion: reduce) { .cloud { animation: none; } }

/* â”€â”€ Lock overlay â”€â”€ */
.lock-overlay {
  position: fixed; inset: 0; z-index: 9999;
  display: flex; align-items: center; justify-content: center;
  background: rgba(4,12,24,0.6);
  backdrop-filter: blur(16px) saturate(130%);
  -webkit-backdrop-filter: blur(16px) saturate(130%);
  transition: opacity .4s;
}
.lock-overlay.hiding { opacity: 0; pointer-events: none; }

.lock-panel {
  width: min(460px,93vw);
  background: linear-gradient(155deg, rgba(255,255,255,0.96), rgba(225,246,255,0.94));
  border-radius: var(--radius-lg); padding: 32px 28px 26px;
  border: 1px solid var(--glass-border);
  box-shadow: 0 40px 80px rgba(0,20,60,0.32), inset 0 1px 0 rgba(255,255,255,0.6);
  display: flex; flex-direction: column; gap: 16px;
  animation: panelIn .5s cubic-bezier(.2,.9,.3,1) both;
}
@keyframes panelIn { from{opacity:0;transform:translateY(20px) scale(.97);} to{opacity:1;transform:none;} }

.lock-logo-row { display: flex; align-items: center; gap: 14px; }
.lock-logo {
  width: 50px; height: 50px; border-radius: 13px; flex-shrink: 0;
  background: linear-gradient(145deg,#d4f0ff,#aadaf5);
  box-shadow: 0 4px 16px rgba(0,80,160,0.12), inset 0 1px 0 rgba(255,255,255,0.7);
  display: flex; align-items: center; justify-content: center;
}
.lock-logo svg { width: 26px; height: 26px; }
.lock-heading { font-family: var(--font-display); font-size: 19px; font-weight: 900; color: #042a3c; }
.lock-sub { font-size: 13px; color: #3a7a99; margin-top: 3px; }

.lock-hint {
  display: flex; align-items: center; gap: 7px;
  background: rgba(14,127,204,0.07); border: 1px solid rgba(14,127,204,0.12);
  border-radius: 100px; padding: 6px 12px; font-size: 12px; color: #185470; width: fit-content;
}

.pass-row { display: flex; gap: 10px; }
.pass-input {
  flex: 1; padding: 12px 14px; border-radius: var(--radius-md);
  border: 1.5px solid rgba(0,0,0,0.07); font-size: 16px; outline: none;
  background: rgba(255,255,255,0.9); color: #042a3c;
  box-shadow: 0 3px 10px rgba(0,0,0,0.04), inset 0 1px 0 white;
  transition: border-color .2s, box-shadow .2s;
  letter-spacing: 4px; font-family: var(--font-body);
}
.pass-input::placeholder { letter-spacing: 0; color: #a0b8c8; }
.pass-input:focus {
  border-color: rgba(14,127,204,0.4);
  box-shadow: 0 0 0 4px rgba(14,127,204,0.15), 0 3px 10px rgba(0,0,0,0.04);
}
.unlock-btn {
  padding: 12px 18px; border-radius: var(--radius-md); border: 0; cursor: pointer;
  background: linear-gradient(145deg,#0e7fcc,#0a6ab5); color: white;
  font-family: var(--font-display); font-size: 10px; font-weight: 700; letter-spacing: 0.5px;
  box-shadow: 0 8px 22px rgba(14,127,204,0.30);
  transition: transform var(--ease), box-shadow var(--ease);
}
.unlock-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 14px 30px rgba(14,127,204,0.38); }
.unlock-btn:disabled { opacity: 0.5; cursor: not-allowed; }

.lock-err {
  display: none; align-items: center; gap: 8px;
  color: var(--danger); background: rgba(192,57,43,0.06);
  padding: 10px 12px; border-radius: var(--radius-sm); border: 1px solid rgba(192,57,43,0.12);
  font-size: 13px;
}
.lock-err.show { display: flex; }
.lock-footer { font-size: 11px; color: #7aaccb; display: flex; justify-content: space-between; gap: 10px; flex-wrap: wrap; }

/* â”€â”€ App shell â”€â”€ */
body.locked { overflow: hidden; }
body.locked .app { filter: blur(8px); pointer-events: none; user-select: none; opacity: 0.35; }

.app {
  position: relative; z-index: 1;
  max-width: 1280px; margin: 0 auto;
  display: flex; flex-direction: column; gap: 14px;
  transition: filter .3s, opacity .3s;
}

/* â”€â”€ Header â”€â”€ */
.header {
  display: flex; align-items: center; gap: 14px;
  background: var(--glass-bg); border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg); padding: 13px 18px;
  box-shadow: 0 8px 32px var(--glass-shadow);
  backdrop-filter: blur(16px) saturate(140%);
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  transition: background .3s, border-color .3s;
}
.header-logo {
  width: 46px; height: 46px; border-radius: var(--radius-md); flex-shrink: 0;
  background: linear-gradient(145deg,#d4f0ff,#aadaf5);
  box-shadow: 0 4px 14px rgba(0,80,160,0.12), inset 0 1px 0 rgba(255,255,255,0.7);
  display: flex; align-items: center; justify-content: center;
}
[data-theme="dark"] .header-logo { background: linear-gradient(145deg,#0e2a42,#0d3555); }
.header-logo svg { width: 24px; height: 24px; }

.header-text h1 {
  font-family: var(--font-display); font-size: clamp(13px,2.2vw,19px);
  font-weight: 900; color: var(--text); letter-spacing: -0.4px; line-height: 1;
}
.header-text .tagline { font-size: 11.5px; color: var(--text-soft); margin-top: 3px; }

.header-actions { margin-left: auto; display: flex; align-items: center; gap: 8px; }

/* Icon button (round glass pill) */
.icon-btn {
  width: 40px; height: 40px; border-radius: 50%;
  border: 1px solid var(--glass-border);
  background: linear-gradient(145deg,rgba(255,255,255,0.85),rgba(220,243,255,0.75));
  box-shadow: 0 4px 12px var(--glass-shadow), inset 0 1px 0 rgba(255,255,255,0.6);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; transition: transform var(--ease), box-shadow var(--ease), background var(--ease);
  flex-shrink: 0; position: relative;
}
[data-theme="dark"] .icon-btn {
  background: linear-gradient(145deg,rgba(30,60,100,0.8),rgba(20,45,80,0.7));
}
.icon-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 22px var(--glass-shadow); }
.icon-btn:active { transform: scale(.96); }
.icon-btn svg { width: 17px; height: 17px; pointer-events: none; }
.icon-btn[aria-pressed="true"] {
  background: linear-gradient(145deg,rgba(14,127,204,0.18),rgba(70,196,227,0.12));
}

/* Tooltip on icon buttons */
.icon-btn::after {
  content: attr(data-tip);
  position: absolute; bottom: calc(100% + 8px); left: 50%; transform: translateX(-50%);
  background: rgba(4,20,40,0.88); color: #d8eeff;
  font-size: 11px; font-family: var(--font-body); font-weight: 500;
  padding: 4px 9px; border-radius: 6px; white-space: nowrap;
  opacity: 0; pointer-events: none; transition: opacity .18s;
}
.icon-btn:hover::after { opacity: 1; }

.contribute-btn {
  padding: 9px 15px; border-radius: var(--radius-md); text-decoration: none;
  background: linear-gradient(145deg,var(--accent),#0a6ab5); color: white;
  font-family: var(--font-display); font-size: 10px; font-weight: 700; letter-spacing: 0.4px;
  box-shadow: 0 6px 18px rgba(14,127,204,0.26);
  transition: transform var(--ease), box-shadow var(--ease);
  white-space: nowrap;
}
.contribute-btn:hover { transform: translateY(-2px); box-shadow: 0 12px 26px rgba(14,127,204,0.34); }

/* â”€â”€ Daily featured banner â”€â”€ */
.featured-banner {
  background: linear-gradient(135deg,rgba(14,127,204,0.12),rgba(70,196,227,0.10));
  border: 1px solid rgba(14,127,204,0.18);
  border-radius: var(--radius-md); padding: 12px 16px;
  display: flex; align-items: center; gap: 14px;
  backdrop-filter: blur(12px); animation: fadeSlide .5s var(--ease) both;
}
[data-theme="dark"] .featured-banner {
  background: linear-gradient(135deg,rgba(56,174,232,0.12),rgba(86,212,245,0.08));
  border-color: rgba(56,174,232,0.18);
}
@keyframes fadeSlide { from{opacity:0;transform:translateY(-8px);} to{opacity:1;transform:none;} }
.featured-icon {
  font-size: 22px; flex-shrink: 0;
  background: linear-gradient(145deg,rgba(255,255,255,0.9),rgba(220,245,255,0.8));
  border-radius: 10px; width: 44px; height: 44px;
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 4px 12px var(--glass-shadow);
}
[data-theme="dark"] .featured-icon { background: rgba(20,50,90,0.8); }
.featured-text { flex: 1; min-width: 0; }
.featured-label {
  font-size: 10.5px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.8px;
  color: var(--accent); font-family: var(--font-display); margin-bottom: 2px;
}
.featured-name { font-weight: 600; font-size: 14px; color: var(--text); }
.featured-host { font-size: 12px; color: var(--text-soft); }
.featured-link {
  flex-shrink: 0; padding: 8px 14px; border-radius: var(--radius-sm);
  background: var(--accent); color: white; text-decoration: none;
  font-size: 12px; font-weight: 600; font-family: var(--font-body);
  box-shadow: 0 4px 12px rgba(14,127,204,0.26);
  transition: transform var(--ease), box-shadow var(--ease);
}
.featured-link:hover { transform: translateY(-1px); box-shadow: 0 8px 18px rgba(14,127,204,0.34); }

/* â”€â”€ Controls row â”€â”€ */
.controls { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }

.search-wrap {
  flex: 1; min-width: 180px;
  display: flex; align-items: center; gap: 9px;
  background: var(--glass-bg); border: 1px solid var(--glass-border);
  border-radius: var(--radius-md); padding: 10px 13px;
  box-shadow: 0 4px 14px var(--glass-shadow);
  backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
  transition: box-shadow .2s, border-color .2s;
}
.search-wrap:focus-within {
  border-color: rgba(14,127,204,0.3);
  box-shadow: 0 0 0 3px var(--accent-glow), 0 4px 14px var(--glass-shadow);
}
.search-wrap svg { flex-shrink: 0; opacity: 0.45; }
.search-wrap input {
  border: 0; outline: none; font-size: 15px; background: transparent;
  width: 100%; color: var(--text); font-family: var(--font-body);
}
.search-wrap input::placeholder { color: var(--text-soft); opacity: 0.7; }
.search-shortcut {
  flex-shrink: 0; background: rgba(0,80,140,0.07); border: 1px solid rgba(0,80,140,0.12);
  border-radius: 5px; padding: 2px 6px; font-size: 11px; color: var(--text-soft);
}

/* Sort select */
.sort-select {
  padding: 9px 12px; border-radius: var(--radius-md);
  border: 1px solid var(--glass-border); background: var(--glass-bg);
  color: var(--text); font-size: 13px; font-family: var(--font-body);
  outline: none; cursor: pointer;
  backdrop-filter: blur(12px);
  box-shadow: 0 4px 14px var(--glass-shadow);
}

/* â”€â”€ Filter pills â”€â”€ */
.filters { display: flex; gap: 7px; flex-wrap: wrap; }
.filter-btn {
  padding: 7px 13px; border-radius: 100px;
  border: 1px solid rgba(0,80,140,0.12);
  background: rgba(255,255,255,0.55); font-size: 12px;
  color: var(--text-mid); cursor: pointer;
  backdrop-filter: blur(8px);
  transition: background var(--ease), border-color var(--ease), color var(--ease), transform var(--ease);
  font-weight: 500; font-family: var(--font-body);
}
[data-theme="dark"] .filter-btn { background: rgba(20,50,90,0.5); border-color: rgba(255,255,255,0.08); }
.filter-btn:hover { background: rgba(255,255,255,0.82); transform: translateY(-1px); }
.filter-btn.active {
  background: linear-gradient(145deg,var(--accent),#0a6ab5); color: white;
  border-color: transparent; box-shadow: 0 4px 14px rgba(14,127,204,0.28);
}

/* â”€â”€ Stats bar â”€â”€ */
.stats-bar {
  display: flex; align-items: center; justify-content: space-between;
  font-size: 12px; color: var(--text-soft); gap: 10px; flex-wrap: wrap;
}
.results-count { font-weight: 600; color: var(--text-mid); }

/* â”€â”€ Grid shell â”€â”€ */
.grid-shell {
  background: rgba(255,255,255,0.36); border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg); padding: 14px;
  box-shadow: 0 12px 40px var(--glass-shadow);
  backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
  min-height: 300px;
  transition: background .3s;
}
[data-theme="dark"] .grid-shell { background: rgba(8,20,44,0.5); }

/* â”€â”€ List view â”€â”€ */
.link-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(var(--grid-min),1fr));
  gap: var(--grid-gap);
}
[data-view="list"] .link-grid {
  grid-template-columns: 1fr;
  gap: 6px;
}
[data-view="list"] .tile { min-height: 52px; padding: 10px 14px; }
[data-view="list"] .tile-icon { width: 34px; height: 34px; flex: 0 0 34px; border-radius: 8px; }
[data-view="list"] .tile-icon img { width: 22px; height: 22px; }
[data-view="list"] .tile-name { font-size: 13.5px; }
[data-view="list"] .tile-host { display: none; }
[data-view="list"] .tile-fav { top: 50%; transform: translateY(-50%); right: 12px; }

/* â”€â”€ Tile â”€â”€ */
.tile {
  position: relative; display: flex; align-items: center; gap: 11px;
  padding: 13px 13px; border-radius: var(--radius-md); text-decoration: none;
  color: var(--text); overflow: hidden; cursor: pointer;
  background: linear-gradient(150deg,rgba(255,255,255,0.84),rgba(232,248,255,0.74));
  border: 1px solid var(--glass-border);
  box-shadow: 0 4px 14px rgba(0,40,90,0.06);
  transition: transform var(--ease), box-shadow var(--ease), background var(--ease), border-color var(--ease);
  min-height: 72px;
  opacity: 0;
  animation: tileIn .38s cubic-bezier(.2,.9,.3,1) both;
}
[data-theme="dark"] .tile {
  background: linear-gradient(150deg,rgba(14,34,68,0.85),rgba(10,26,54,0.78));
}
.tile:hover {
  transform: translateY(-8px);
  box-shadow: 0 22px 44px rgba(0,40,100,0.14), 0 0 0 1px rgba(14,127,204,0.14);
  background: linear-gradient(150deg,rgba(255,255,255,0.96),rgba(230,250,255,0.88));
}
[data-theme="dark"] .tile:hover {
  background: linear-gradient(150deg,rgba(18,42,80,0.95),rgba(14,34,68,0.9));
}
.tile::after {
  content:''; position:absolute; inset:0; border-radius:inherit;
  background: linear-gradient(105deg,transparent 40%,rgba(255,255,255,0.35) 60%,transparent 75%);
  opacity: 0; transition: opacity .3s; pointer-events: none;
}
.tile:hover::after { opacity: 1; }
.tile.fav-tile { border-color: rgba(245,166,35,0.30); }
[data-theme="dark"] .tile.fav-tile { border-color: rgba(245,166,35,0.20); }

@keyframes tileIn {
  from { opacity:0; transform:translateY(12px) scale(.985); }
  to   { opacity:1; transform:none; }
}

.tile-icon {
  width: 44px; height: 44px; border-radius: 10px; flex-shrink: 0;
  background: linear-gradient(145deg,#eaf6ff,#d0ecff);
  border: 1px solid rgba(255,255,255,0.7);
  display: flex; align-items: center; justify-content: center; overflow: hidden;
  box-shadow: 0 3px 9px rgba(0,60,120,0.08);
}
[data-theme="dark"] .tile-icon { background: linear-gradient(145deg,#0e2a42,#0d3555); border-color: rgba(255,255,255,0.06); }
.tile-icon img { width: 28px; height: 28px; object-fit: contain; }

.tile-body { display: flex; flex-direction: column; min-width: 0; flex: 1; }
.tile-name { font-weight: 600; font-size: 13.5px; color: var(--text); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.tile-host { font-size: 11.5px; color: var(--text-soft); margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* Favourite star */
.tile-fav {
  position: absolute; top: 8px; right: 8px;
  width: 24px; height: 24px; border-radius: 50%; border: 0;
  background: rgba(255,255,255,0.6); cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  opacity: 0; transition: opacity .2s, transform .2s, background .2s;
  z-index: 2;
}
[data-theme="dark"] .tile-fav { background: rgba(30,60,100,0.6); }
.tile:hover .tile-fav, .tile-fav.active { opacity: 1; }
.tile-fav svg { width: 13px; height: 13px; pointer-events: none; }
.tile-fav.active { background: rgba(245,166,35,0.15); }
.tile-fav.active svg path { fill: var(--star-active); stroke: var(--star-active); }
.tile-fav:hover { transform: scale(1.2); }

/* "New" badge */
.tile-badge-new {
  position: absolute; bottom: 8px; right: 8px;
  background: linear-gradient(135deg,#38c85a,#0a9e6e);
  color: white; font-size: 9px; font-weight: 700; font-family: var(--font-display);
  padding: 2px 6px; border-radius: 100px; letter-spacing: 0.5px;
  pointer-events: none;
}

/* Report button */
.tile-report {
  position: absolute; bottom: 8px; left: 8px;
  background: rgba(192,57,43,0.10); border: 1px solid rgba(192,57,43,0.15);
  border-radius: 6px; padding: 2px 8px;
  color: var(--danger); font-size: 10px; font-weight: 600; cursor: pointer;
  opacity: 0; transition: opacity .2s; z-index: 2;
  display: flex; align-items: center; gap: 4px;
}
.tile:hover .tile-report { opacity: 1; }

/* â”€â”€ Recently visited strip â”€â”€ */
.recent-section { display: flex; flex-direction: column; gap: 8px; }
.recent-label {
  font-size: 11px; font-weight: 600; color: var(--text-soft);
  text-transform: uppercase; letter-spacing: 0.6px;
}
.recent-strip { display: flex; gap: 8px; flex-wrap: wrap; }
.recent-chip {
  display: flex; align-items: center; gap: 7px;
  padding: 6px 11px; border-radius: 100px; text-decoration: none;
  background: var(--glass-bg); border: 1px solid var(--glass-border);
  font-size: 12px; color: var(--text-mid); font-weight: 500;
  box-shadow: 0 3px 10px var(--glass-shadow);
  transition: transform var(--ease), box-shadow var(--ease);
  backdrop-filter: blur(8px);
}
.recent-chip:hover { transform: translateY(-2px); box-shadow: 0 8px 18px var(--glass-shadow); }
.recent-chip img { width: 16px; height: 16px; border-radius: 4px; object-fit: contain; }

/* â”€â”€ Empty state â”€â”€ */
.empty {
  display: none; flex-direction: column; align-items: center; justify-content: center;
  padding: 56px 20px; text-align: center; gap: 10px; color: var(--text-soft);
}
.empty.show { display: flex; }
.empty svg { opacity: 0.3; width: 44px; height: 44px; }
.empty-title { font-family: var(--font-display); font-size: 15px; font-weight: 700; color: var(--text-mid); }
.empty-sub { font-size: 13px; }

/* â”€â”€ Spinner overlay â”€â”€ */
.spinner-overlay {
  position: fixed; inset: 0; z-index: 8000;
  display: flex; align-items: center; justify-content: center;
  background: rgba(4,12,24,0.5);
  backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
  opacity: 0; pointer-events: none; transition: opacity .3s;
}
.spinner-overlay.open { opacity: 1; pointer-events: all; }
.spinner-card {
  width: min(400px,90vw);
  background: var(--glass-bg); border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg); padding: 32px 28px;
  box-shadow: 0 32px 64px rgba(0,20,60,0.26);
  display: flex; flex-direction: column; align-items: center; gap: 16px;
  text-align: center;
  transform: scale(.95); transition: transform .32s cubic-bezier(.2,.9,.3,1);
}
.spinner-overlay.open .spinner-card { transform: none; }
.spinner-emoji { font-size: 52px; animation: spinBounce .6s infinite alternate; }
@keyframes spinBounce { from{transform:scale(1) rotate(-5deg);} to{transform:scale(1.1) rotate(5deg);} }
.spinner-title { font-family: var(--font-display); font-size: 16px; font-weight: 900; color: var(--text); }
.spinner-name { font-size: 20px; font-weight: 700; color: var(--accent); font-family: var(--font-display); }
.spinner-host { font-size: 13px; color: var(--text-soft); }
.spinner-actions { display: flex; gap: 10px; margin-top: 4px; }
.spinner-go {
  padding: 11px 22px; border-radius: var(--radius-md); border: 0; cursor: pointer;
  background: linear-gradient(145deg,var(--accent),#0a6ab5); color: white;
  font-family: var(--font-display); font-size: 11px; font-weight: 700; letter-spacing: 0.5px;
  box-shadow: 0 6px 18px rgba(14,127,204,0.28);
  transition: transform var(--ease), box-shadow var(--ease);
  text-decoration: none; display: inline-block;
}
.spinner-go:hover { transform: translateY(-2px); box-shadow: 0 12px 26px rgba(14,127,204,0.36); }
.spinner-again {
  padding: 11px 16px; border-radius: var(--radius-md); border: 1px solid var(--glass-border);
  background: var(--glass-bg); color: var(--text-mid);
  font-family: var(--font-body); font-size: 13px; font-weight: 600; cursor: pointer;
  transition: background var(--ease);
}
.spinner-again:hover { background: rgba(255,255,255,0.85); }
.spinner-close {
  position: absolute; top: 14px; right: 14px;
  width: 30px; height: 30px; border-radius: 50%; border: 1px solid var(--glass-border);
  background: var(--glass-bg); cursor: pointer; display: flex; align-items: center; justify-content: center;
  font-size: 16px; color: var(--text-soft);
}

/* â”€â”€ Footer â”€â”€ */
.footer {
  display: flex; align-items: center; justify-content: space-between;
  font-size: 12px; color: var(--text-soft); flex-wrap: wrap; gap: 8px;
}
.footer a { color: var(--accent); text-decoration: none; }
.footer a:hover { text-decoration: underline; }
.note-pill {
  display: flex; align-items: center; gap: 6px;
  background: rgba(255,255,255,0.48); border: 1px solid rgba(0,80,140,0.10);
  border-radius: 100px; padding: 5px 12px;
  backdrop-filter: blur(8px);
}
[data-theme="dark"] .note-pill { background: rgba(14,34,68,0.6); border-color: rgba(255,255,255,0.08); }

/* â”€â”€ Toast â”€â”€ */
.toast {
  position: fixed; bottom: 20px; right: 20px; z-index: 99999;
  background: rgba(255,255,255,0.92); border: 1px solid var(--glass-border);
  border-radius: var(--radius-md); padding: 10px 16px;
  box-shadow: 0 12px 32px rgba(0,30,60,0.14);
  font-size: 13px; color: var(--text);
  display: flex; align-items: center; gap: 8px;
  opacity: 0; transform: translateY(10px); pointer-events: none;
  transition: opacity .28s, transform .28s;
  backdrop-filter: blur(12px); max-width: 280px;
}
[data-theme="dark"] .toast { background: rgba(12,28,60,0.94); }
.toast.show { opacity: 1; transform: none; }
.toast-dot { width: 7px; height: 7px; border-radius: 50%; background: var(--accent); flex-shrink: 0; }

/* â”€â”€ Scrollbar â”€â”€ */
::-webkit-scrollbar { width: 8px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb {
  background: rgba(14,127,204,0.18); border-radius: 8px;
  border: 2px solid transparent; background-clip: padding-box;
}
::-webkit-scrollbar-thumb:hover { background: rgba(14,127,204,0.30); }

/* â”€â”€ Focus â”€â”€ */
*:focus-visible { outline: 3px solid var(--accent-glow); outline-offset: 3px; }

/* â”€â”€ Responsive â”€â”€ */
@media (max-width:680px) {
  .link-grid { grid-template-columns: repeat(auto-fill,minmax(150px,1fr)); }
  .header-text h1 { font-size: 13px; }
  .contribute-btn { display: none; }
  .sort-select { display: none; }
  .header { padding: 10px 12px; gap: 10px; }
  .icon-btn { width: 36px; height: 36px; }
}
@media (max-width:400px) {
  .link-grid { grid-template-columns: 1fr 1fr; }
  .filters { display: none; }
}
</style>
</head>

<body class="locked">

<!-- â”€â”€ Custom cursor â”€â”€ -->
<div class="cursor-dot"  id="cursorDot"  aria-hidden="true"></div>
<div class="cursor-ring" id="cursorRing" aria-hidden="true"></div>

<!-- â”€â”€ Clouds â”€â”€ -->
<div class="clouds" aria-hidden="true">
  <div class="cloud"></div>
  <div class="cloud"></div>
  <div class="cloud"></div>
  <div class="cloud"></div>
</div>

<!-- â”€â”€ Seasonal particles (populated by JS) â”€â”€ -->
<div class="snowflakes" id="snowflakes" aria-hidden="true"></div>
<div class="leaves"     id="leaves"     aria-hidden="true"></div>
<div class="blossoms"   id="blossoms"   aria-hidden="true"></div>

<!-- ======================================================
     LOCK OVERLAY
====================================================== -->
<div class="lock-overlay" id="lockOverlay" role="dialog" aria-modal="true" aria-labelledby="lockTitle">
  <div class="lock-panel">
    <div class="lock-logo-row">
      <div class="lock-logo" aria-hidden="true">
        <svg viewBox="0 0 28 28" fill="none">
          <rect x="3" y="8" width="22" height="14" rx="4" stroke="#0e7fcc" stroke-width="1.8"/>
          <path d="M9 15h4m-2-2v4" stroke="#0e7fcc" stroke-width="1.8" stroke-linecap="round"/>
          <circle cx="20" cy="15" r="1.2" fill="#0e7fcc"/>
          <circle cx="17" cy="15" r="1.2" fill="#46c4e3"/>
          <path d="M10 8V6a4 4 0 0 1 8 0v2" stroke="#0e7fcc" stroke-width="1.8" stroke-linecap="round"/>
        </svg>
      </div>
      <div>
        <div class="lock-heading" id="lockTitle">Enter access code</div>
        <div class="lock-sub">This gallery is access-protected.</div>
      </div>
    </div>
    <div class="lock-hint" aria-hidden="true">
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
        <path d="M12 2a5 5 0 0 1 5 5v2H7V7a5 5 0 0 1 5-5z" stroke="#185470" stroke-width="1.8" stroke-linejoin="round"/>
        <rect x="3" y="9" width="18" height="13" rx="3" stroke="#185470" stroke-width="1.8"/>
        <circle cx="12" cy="15.5" r="1.5" fill="#185470"/>
      </svg>
      Numeric only â€” press Enter to confirm
    </div>
    <div class="pass-row">
      <input class="pass-input" id="passInput" type="password" inputmode="numeric"
             pattern="[0-9]*" maxlength="10" autocomplete="one-time-code"
             aria-label="Access code" placeholder="â€¢â€¢â€¢â€¢"/>
      <button class="unlock-btn" id="passBtn">UNLOCK</button>
    </div>
    <div class="lock-err" id="errMsg" role="alert" aria-live="polite">
      <svg width="15" height="15" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="#c0392b" stroke-width="1.8"/>
        <path d="M12 8v5" stroke="#c0392b" stroke-width="1.8" stroke-linecap="round"/>
        <circle cx="12" cy="16.5" r="1" fill="#c0392b"/>
      </svg>
      <span id="errText">Incorrect code â€” try again.</span>
    </div>
    <div class="lock-footer">
      <span>Music plays after unlock â€” use mute button to stop.</span>
      <span>Session remembered per tab.</span>
    </div>
  </div>
</div>

<!-- ======================================================
     RANDOM GAME SPINNER
====================================================== -->
<div class="spinner-overlay" id="spinnerOverlay" role="dialog" aria-modal="true" aria-label="Random game">
  <div class="spinner-card" style="position:relative;">
    <button class="spinner-close" id="spinnerClose" aria-label="Close">Ã—</button>
    <div class="spinner-emoji">ğŸ²</div>
    <div class="spinner-title">Your random game isâ€¦</div>
    <div class="spinner-name" id="spinnerName">â€”</div>
    <div class="spinner-host" id="spinnerHost">â€”</div>
    <div class="spinner-actions">
      <a class="spinner-go" id="spinnerGo" href="#" target="_blank" rel="noopener">Play now â†—</a>
      <button class="spinner-again" id="spinnerAgain">Try another</button>
    </div>
  </div>
</div>

<!-- ======================================================
     MAIN APP
====================================================== -->
<div class="app" id="app" data-view="grid">

  <!-- Header -->
  <header class="header">
    <div class="header-logo" aria-hidden="true">
      <svg viewBox="0 0 28 28" fill="none">
        <rect x="3" y="8" width="22" height="14" rx="4" stroke="#0e7fcc" stroke-width="1.7"/>
        <path d="M9 15h4m-2-2v4" stroke="#0e7fcc" stroke-width="1.7" stroke-linecap="round"/>
        <circle cx="20" cy="15" r="1.2" fill="#0e7fcc"/>
        <circle cx="17" cy="15" r="1.2" fill="#46c4e3"/>
        <path d="M10 8V6a4 4 0 0 1 8 0v2" stroke="#0e7fcc" stroke-width="1.7" stroke-linecap="round"/>
      </svg>
    </div>
    <div class="header-text">
      <h1>The Game Gallery</h1>
      <div class="tagline">Frutiger Aero Edition Â· all links open in new tab<span class="season-pill" id="seasonPill"></span></div>
    </div>
    <div class="header-actions">

      <!-- Random game -->
      <button class="icon-btn" id="randomBtn" data-tip="Random game" aria-label="Random game">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M16 3h5v5M8 3H3v5m13 13h5v-5M8 21H3v-5" stroke="var(--accent)" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="12" cy="12" r="2" fill="var(--accent)"/>
        </svg>
      </button>

      <!-- View toggle: grid / list -->
      <button class="icon-btn" id="viewBtn" data-tip="Toggle list view" aria-pressed="false" aria-label="Toggle view">
        <svg viewBox="0 0 24 24" fill="none">
          <rect x="3" y="4" width="18" height="4" rx="1.5" fill="var(--accent)"/>
          <rect x="3" y="10" width="18" height="4" rx="1.5" fill="var(--accent)" opacity=".6"/>
          <rect x="3" y="16" width="18" height="4" rx="1.5" fill="var(--accent)" opacity=".3"/>
        </svg>
      </button>

      <!-- Dark mode -->
      <button class="icon-btn" id="themeBtn" data-tip="Toggle dark mode" aria-label="Toggle dark mode">
        <svg viewBox="0 0 24 24" fill="none">
          <path id="themeIcon" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" fill="var(--accent)" stroke="var(--accent)" stroke-width="1.3"/>
        </svg>
      </button>

      <!-- Compact mode -->
      <button class="icon-btn" id="compactBtn" data-tip="Compact tiles" aria-pressed="false" aria-label="Toggle compact mode">
        <svg viewBox="0 0 24 24" fill="none">
          <rect x="2" y="2" width="9" height="9" rx="2" fill="var(--accent)"/>
          <rect x="13" y="2" width="9" height="9" rx="2" fill="var(--accent)" opacity=".6"/>
          <rect x="2" y="13" width="9" height="9" rx="2" fill="var(--accent)" opacity=".6"/>
          <rect x="13" y="13" width="9" height="9" rx="2" fill="var(--accent)" opacity=".3"/>
        </svg>
      </button>

      <!-- Mute -->
      <button class="icon-btn" id="audioBtn" data-tip="Play / mute music" aria-pressed="false" aria-label="Toggle music">
        <svg id="audioIconSvg" viewBox="0 0 24 24" fill="none">
          <path d="M5 9v6h4l5 4V5L9 9H5z" fill="var(--accent)"/>
          <g id="speakerWaves">
            <path d="M16.5 8.5a5 5 0 0 1 0 7" stroke="var(--accent)" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M19 6a9 9 0 0 1 0 12" stroke="var(--accent-2)" stroke-width="1.4" stroke-linecap="round" opacity=".5"/>
          </g>
          <path id="muteX" d="M17 9l4 6m0-6l-4 6" stroke="var(--danger)" stroke-width="1.7" stroke-linecap="round" style="display:none"/>
        </svg>
      </button>

      <a class="contribute-btn" href="https://github.com/Red404441/Games-gallery-" target="_blank" rel="noopener">Contribute â†—</a>
    </div>
  </header>

  <!-- Daily featured game -->
  <div class="featured-banner" id="featuredBanner" aria-label="Game of the day">
    <div class="featured-icon" id="featuredIcon">ğŸ®</div>
    <div class="featured-text">
      <div class="featured-label">â˜€ï¸ Game of the Day</div>
      <div class="featured-name" id="featuredName">Loadingâ€¦</div>
      <div class="featured-host" id="featuredHost"></div>
    </div>
    <a class="featured-link" id="featuredLink" href="#" target="_blank" rel="noopener">Play â†—</a>
  </div>

  <!-- Recently visited -->
  <div class="recent-section" id="recentSection" style="display:none">
    <div class="recent-label">Recently visited</div>
    <div class="recent-strip" id="recentStrip"></div>
  </div>

  <!-- Controls -->
  <div class="controls">
    <div class="search-wrap">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
        <path d="M21 21l-4.35-4.35" stroke="var(--text-mid)" stroke-width="1.8" stroke-linecap="round"/>
        <circle cx="11" cy="11" r="7" stroke="var(--text-mid)" stroke-width="1.8"/>
      </svg>
      <input id="searchInput" type="search" placeholder="Search gamesâ€¦ (press /)" aria-label="Search games" autocomplete="off" spellcheck="false"/>
      <kbd class="search-shortcut">/</kbd>
    </div>
    <select class="sort-select" id="sortSelect" aria-label="Sort games">
      <option value="default">Default order</option>
      <option value="az">A â†’ Z</option>
      <option value="za">Z â†’ A</option>
      <option value="favs">Favourites first</option>
    </select>
    <div class="filters" id="filterBar" role="group" aria-label="Filter by category"></div>
  </div>

  <!-- Stats -->
  <div class="stats-bar">
    <span class="results-count" id="resultsCount">Loadingâ€¦</span>
    <span id="activeFilterLabel" style="font-size:12px;"></span>
  </div>

  <!-- Grid -->
  <div class="grid-shell">
    <div class="link-grid" id="linkGrid" role="list" aria-live="polite" aria-label="Games"></div>
    <div class="empty" id="emptyState">
      <svg viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="var(--text-soft)" stroke-width="1.5"/>
        <path d="M9 9l6 6m0-6l-6 6" stroke="var(--text-soft)" stroke-width="1.5" stroke-linecap="round"/>
      </svg>
      <div class="empty-title">Nothing found</div>
      <div class="empty-sub">Try a different search or clear the filter.</div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="note-pill">
      <svg width="13" height="13" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="var(--text-soft)" stroke-width="1.6"/>
        <path d="M12 8v5" stroke="var(--text-soft)" stroke-width="1.6" stroke-linecap="round"/>
        <circle cx="12" cy="16.5" r="1" fill="var(--text-soft)"/>
      </svg>
      Some links may be blocked by filters. Report broken links via GitHub.
    </div>
    <div>
      <a href="https://github.com/Red404441/Games-gallery-" target="_blank" rel="noopener">GitHub â†—</a>
      &nbsp;Â·&nbsp; Built with â˜ï¸
    </div>
  </footer>
</div>

<!-- Toast -->
<div class="toast" id="toast" role="status" aria-live="polite">
  <div class="toast-dot"></div>
  <span id="toastMsg"></span>
</div>

<!-- Pocket bird easter egg -->
<script src="https://cdn.jsdelivr.net/gh/IdreesInc/Pocket-Bird@main/dist/web/birb.embed.js"></script>

<script>
'use strict';

/* ======================================================================
   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
   DATA â€” HOW TO ADD LINKS
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Add a new entry inside the LINKS array:
     { name:"Game Name", url:"https://example.com/", cat:"hub", added:"2025-01-01" },

   HOW TO ADD A CATEGORY
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1. Choose a short key, e.g.  "action"
   2. Add it to CAT_LABELS:     action: 'Action',
   3. Use it on links:          cat:"action"
   ====================================================================== */

const LINKS = [
  /* â”€â”€ .io Games â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  { name:"Diep.io",              url:"https://diep.io/",                      cat:"io" },
  { name:"Wings.io",             url:"https://wings.io/",                     cat:"io" },
  { name:"Deeeep.io",            url:"https://deeeep.io/",                    cat:"io" },
  { name:"Brutal.io",            url:"https://brutal.io/",                    cat:"io" },
  { name:"Paper.io",             url:"https://paper-io.com/",                 cat:"io" },
  { name:"Slither.io",           url:"https://slither.io/",                   cat:"io" },
  { name:"Yorg.io",              url:"https://yorg.io/",                      cat:"io" },
  { name:"Venge.io",             url:"https://venge.io/",                     cat:"io" },
  { name:"Warbot.io",            url:"https://warbot.io/",                    cat:"io" },
  { name:"Garlic.io",            url:"https://garlic.io/",                    cat:"io" },
  { name:"Snake.io",             url:"https://snake.io/",                     cat:"io" },
  { name:"Zombs.io",             url:"https://zombs.io/",                     cat:"io" },
  { name:"Hordes.io",            url:"https://hordes.io/",                    cat:"io" },
  { name:"Kour.io",              url:"https://kour.io/",                      cat:"io" },
  { name:"Deadshot.io",          url:"https://deadshot.io/",                  cat:"io" },
  { name:"Narrow.one",           url:"https://narrow.one/",                   cat:"io" },
  { name:"Territorial.io",       url:"https://territorial.io/",               cat:"io" },
  { name:"Drift.io",             url:"https://drift.io/?room=nedRVhuAq",      cat:"io" },
  { name:"BasketBros.io",        url:"https://basketbrosio.com/",             cat:"io" },
  { name:"YoHoHo.io",            url:"https://yohoho.io/",                    cat:"io" },
  { name:"Growden",              url:"https://growden.io/",                   cat:"io" },
  { name:"Overtide",             url:"https://overtide.io/",                  cat:"io" },
  { name:"Poxel",                url:"https://poxel.io/",                     cat:"io" },
  { name:"KourStrike",           url:"https://kourstrike.io/",                cat:"io" },
  { name:"FoodStars",            url:"https://foodstars.io/",                 cat:"io" },
  { name:"2v2.io",               url:"https://2v2.io/",                       cat:"io" },
  { name:"Veck.io",              url:"https://veck.io/",                      cat:"io" },

  /* â”€â”€ Classic Games â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  { name:"Chess.com",            url:"https://www.chess.com/",                cat:"classic" },
  { name:"Jetpack Joyride",      url:"https://jetpack-joyride.github.io/",    cat:"classic" },
  { name:"Tetris",               url:"https://www.lumpty.com/amusements/games/tetris/tetris.html", cat:"classic" },
  { name:"Card Games.io",        url:"https://cardgames.io/",                 cat:"classic" },
  { name:"Polytrack",            url:"https://www.kodub.com/apps/polytrack",  cat:"classic" },
  { name:"PokÃ©mon Showdown",     url:"https://play.pokemonshowdown.com/",     cat:"classic" },
  { name:"FreeRiderHD",          url:"https://www.freeriderhd.com/",          cat:"classic" },
  { name:"Slice Master",         url:"https://slice-master.io/",              cat:"classic" },
  { name:"NoInternetGame",       url:"https://nointernetgame.com/",           cat:"classic" },
  { name:"CatMario",             url:"https://catmario.eu/",                  cat:"classic" },
  { name:"MCraft",               url:"https://mcraft.fun/",                   cat:"classic" },
  { name:"Eaglercraft",          url:"https://eaglercraft.q13x.com/1.8-js/?retina=true", cat:"classic" },
  { name:"Cookie Clicker",       url:"https://cookieclicker.one/",            cat:"classic" },
  { name:"PokeRogue",            url:"https://pokerogue.io/",                 cat:"classic" },
  { name:"Tetr.io",              url:"https://tetr.io/",                      cat:"classic" },
  { name:"Crossy Road",          url:"https://crossy-road.io/",               cat:"classic" },
  { name:"Mario 64 Online",      url:"https://red404441.github.io/Mario64-online/", cat:"classic" },
  { name:"Osu!",                 url:"https://webosu.online/",                cat:"classic" },
  { name:"BloxD",                url:"https://bloxd.io/",                     cat:"classic" },

  /* â”€â”€ Game Hubs / Portals â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  { name:"Win10 Games Hub",      url:"https://win10.webjeet.me/",             cat:"hub" },
  { name:"Armor Games",          url:"https://armorgames.com/",               cat:"hub" },
  { name:"FreeGames.com",        url:"https://www.freegames.com/",            cat:"hub" },
  { name:"Lagged.com",           url:"https://lagged.com/en/",                cat:"hub" },
  { name:"GamePix",              url:"https://www.gamepix.com/",              cat:"hub" },
  { name:"Pogo.com",             url:"https://www.pogo.com/",                 cat:"hub" },
  { name:"Gamezop",              url:"https://www.gamezop.com/en",            cat:"hub" },
  { name:"Jopi.com",             url:"https://www.jopi.com/",                 cat:"hub" },
  { name:"Poki",                 url:"https://poki.ac/",                      cat:"hub" },
  { name:"Friv2online",          url:"https://www.friv2online.com/poki-games",cat:"hub" },
  { name:"FreeGames.org",        url:"https://freegames.org/",                cat:"hub" },
  { name:"Cool Math Games",      url:"https://www.coolmathgames.com/",        cat:"hub" },
  { name:"ArcadeSpot",           url:"https://arcadespot.com/",               cat:"hub" },
  { name:"Now.gg",               url:"https://now.gg/",                       cat:"hub" },
  { name:"PlayRetroGames",       url:"https://playretrogames.online/",        cat:"hub" },
  { name:"Gamaverse Mobile",     url:"https://gamaverse.com/mobile/",         cat:"hub" },
  { name:"KBHGames",             url:"https://kbhgames.com/",                 cat:"hub" },
  { name:"Desura Games",         url:"https://www.desura.games/ipad-games",   cat:"hub" },
  { name:"Toogame",              url:"https://www.toogame.com/",              cat:"hub" },
  { name:"GameSnacks",           url:"https://gamesnacks.com/",               cat:"hub" },
  { name:"Yapi Games",           url:"https://www.yapigames.com/mobilegames/",cat:"hub" },
  { name:"Games Unblocked",      url:"https://sites.google.com/view/games-unblocked/", cat:"hub" },
  { name:"Watch Doc Games",      url:"https://watchdocumentaries.com/games/", cat:"hub" },
  { name:"Gameflare",            url:"https://www.gameflare.com/",            cat:"hub" },
  { name:"PlayHop",              url:"https://playhop.com/",                  cat:"hub" },
  { name:"Miniclip",             url:"https://www.miniclip.com/",             cat:"hub" },
  { name:"GeForce Now",          url:"https://www.geforce.com/",              cat:"hub" },
  { name:"AzGames",              url:"https://azgames.io/?gid=S50",           cat:"hub" },
  { name:"Uptoplay",             url:"https://uptoplay.net/",                 cat:"hub" },
  { name:"1games.io",            url:"https://1games.io/",                    cat:"hub" },
  { name:"Ant Games",            url:"https://ant.games/",                    cat:"hub" },
  { name:"4ian Games",           url:"https://github.com/4ian/games?tab=readme-ov-file", cat:"hub" },
  { name:"AllGames",             url:"https://allgamesgithub.gitlab.io/",     cat:"hub" },
  { name:"HTML5 Games",          url:"https://html5-games.github.io/",        cat:"hub" },
  { name:"Unblocked GG",         url:"https://unblockedgamesgg.github.io/",   cat:"hub" },
  { name:"Free Unblocked",       url:"https://freeunblockedgames.github.io/", cat:"hub" },
  { name:"FreebieGames",         url:"https://freebie.games/",                cat:"hub" },
  { name:"UG17 Games",           url:"https://ug17.github.io/",               cat:"hub" },
  { name:"MAFA.com",             url:"https://www.mafa.com/",                 cat:"hub" },
  { name:"Games-Site",           url:"https://games-site.github.io/",         cat:"hub" },
  {name:"Poki", url:"poki.com", cat:"hub", added:"2026-02-24"},
  {name:"Soups Notes", url:"https://salmanhcetss.github.io/Notes_soup/", cat:"hub", added:"2026-02-24"},
  {name:"Turbowarp", url:"https://turbowarp.org/", cat:"hub", added:"2026-02-26"},

  /* â”€â”€ Fun / Miscellaneous â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  { name:"QuickDraw",            url:"https://quickdraw.withgoogle.com/",     cat:"fun" },
  { name:"Neal.fun",             url:"https://neal.fun/",                     cat:"fun" },
  { name:"Akinator",             url:"https://en.akinator.com/",              cat:"fun" },
  { name:"KoalaBeast",           url:"https://koalabeast.com/",               cat:"fun" },
  { name:"Oasis Starting Point", url:"https://oasis.decart.ai/starting-point?journey=Dense+Forest", cat:"fun" },
  { name:"Corru Observer",       url:"https://corru.observer/",               cat:"fun" },
  { name:"Among Us Online",      url:"https://amongusplay.online/",           cat:"fun" },
  { name:"Time Shooter 2",       url:"https://watchdocumentaries.com/time-shooter-2-game/", cat:"fun" },
  { name:"Combat Reloaded",      url:"https://www.gameflare.com/online-game/combat-reloaded/", cat:"fun" },
  { name:"Two Player Games",     url:"https://www.twoplayergames.org/",       cat:"fun" },
  { name:"Slowroads.io",         url:"https://slowroads.io/",                 cat:"fun" },
  { name:"Exhibit of Sorrows",   url:"https://www.izzygames.com/exhibit-of-sorrows-t6997.html?fullscreen=true", cat:"fun" },
  { name:"Slendrina: The Cellar",url:"https://kevin.games/slendrina-must-die-the-cellar", cat:"fun" },
  { name:"Smash Karts",          url:"https://smashkarts.io/",                cat:"fun" },
  { name:"Skibidi.io",           url:"https://skibidi.io/games",              cat:"fun" },
  { name:"AngusNicNeven",        url:"https://angusnicneven.com/",            cat:"fun" },
  { name:"Elgoog",               url:"https://elgoog.im/",                    cat:"fun" },
  { name:"Frutiger Aero Archive",url:"https://frutigeraeroarchive.org/",      cat:"fun" },
  { name:"Mesa Redux",           url:"https://mesaredux.duccman99.workers.dev/", cat:"fun" },
  { name:"Survival Race",        url:"https://www.onlinegames.io/survival-race/index.html", cat:"fun" },
  { name:"Among Us (Scratch)",   url:"https://scratch.mit.edu/projects/523967150/", cat:"fun" },
  { name:"PIXEL VALLEY Online",  url:"https://scratch.mit.edu/projects/551905179/", cat:"fun" },
  { name:"Getting Over It Online",url:"https://scratch.mit.edu/projects/390983761/", cat:"fun" },
  { name:"Downgrade 2",          url:"https://turbowarp.org/1115559391/fullscreen?fps=60&clones=Infinity&limitless&hqpen&size=640x360", cat:"fun" },
  {name:"youtube", url:"youtube.com", cat:"fun"},
  {name:"Play", url:"https://play.pokemonshowdown.com/", cat:"fun", added:"2026-02-27"},

  /* â”€â”€ Retro / OS / Emulation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  { name:"EmuOS",                url:"https://emupedia.net/beta/emuos/",      cat:"retro" },
  { name:"Windows 93",           url:"https://v1.windows93.net/",             cat:"retro" },
  { name:"VirtualXP",            url:"https://lrusso.github.io/VirtualXP/VirtualXP.htm", cat:"retro" },
  { name:"PCJS",                 url:"https://www.pcjs.org/blog/2015/09/21/", cat:"retro" },
  { name:"Lexaloffle",           url:"https://www.lexaloffle.com/bbs/?pid=136646#playing", cat:"retro" },
  { name:"MyEmulator",           url:"https://myemulator.onl/",               cat:"retro" },
  { name:"Internet Arcade",      url:"https://archive.org/details/internetarcade", cat:"retro" },
  { name:"RomsFun",              url:"https://romsfun.com/",                  cat:"retro" },
  { name:"JS Linux",             url:"https://bellard.org/jslinux/",          cat:"retro" },

  /* â”€â”€ Education â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  { name:"Maths Playground",     url:"https://www.mathplayground.com/fun-skill-games.html", cat:"edu" },
  { name:"MathPlayZone Arcade",  url:"https://mathplayzone.com/arcade/",      cat:"edu" },
  { name:"Kahoot Bot",           url:"https://kahootbot.net/",                cat:"edu" },
  { name:"Duck Math",            url:"https://duckmath.org/",                 cat:"edu" },
  { name:"GN Math",              url:"https://gn-math.github.io/",            cat:"edu" },
  { name:"Memory Games",         url:"https://memory.toys/",                  cat:"edu" },

  /* â”€â”€ Simulation / RPG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  { name:"BitLife",              url:"https://bitlifeonline.io/home",          cat:"sim" },
  { name:"Fallen London",        url:"https://www.fallenlondon.com/",          cat:"sim" },
  { name:"Granblue Fantasy",     url:"https://granbluefantasy.jp/sp/en/",      cat:"sim" },

  /* â”€â”€ Proxy / Unblocker â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  {name:"Startpage", url:"https://startpage.com", cat:"proxy", added:"2026-02-25"},
];

/* ======================================================================
   CATEGORIES
   ====================================================================== */
const CAT_LABELS = {
  all:     'All',
  io:      '.io Games',
  hub:     'Hubs',
  classic: 'Classics',
  fun:     'Fun',
  retro:   'Retro / OS',
  edu:     'Education',
  sim:     'Simulation',
  proxy:   'Unblocker',
};

/* ======================================================================
   CONFIG
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   LOCK_HASH: SHA-256 of the access code. The plain-text code is NOT
   stored here. To change the code:
     1. Run in your browser console:
        crypto.subtle.digest('SHA-256', new TextEncoder().encode('YOURNEWCODE'))
          .then(b => console.log(Array.from(new Uint8Array(b)).map(x=>x.toString(16).padStart(2,'0')).join('')))
     2. Paste the resulting hex string as LOCK_HASH below.

   Rate limiting: MAX_ATTEMPTS wrong guesses trigger a LOCKOUT_MS cooldown.
   ====================================================================== */
const CONFIG = {
  LOCK_HASH:      '886b73d4b098e551f1dbb54ef2b55ef41981908b9b3c1b8fe7c442f26f0fa63d',
  MAX_ATTEMPTS:    5,
  LOCKOUT_MS:      30000,        // 30 seconds
  NEW_BADGE_DAYS:  14,
  RECENT_MAX:      8,
  AUDIO_SRC:       'Music.mp3',
  AUDIO_VOLUME:    0.55,
  GITHUB_REPO:     'Red404441/Games-gallery-',
};

/* ======================================================================
   UTILITIES
   ====================================================================== */
const $ = id => document.getElementById(id);

function favUrl(url){
  try{ return `https://www.google.com/s2/favicons?domain=${new URL(url).hostname}&sz=64`; }
  catch{ return ''; }
}
function hostOf(url){
  try{ return new URL(url).hostname.replace(/^www\./, ''); }
  catch{ return url; }
}
const XP_FALLBACK = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40'%3E%3Crect rx='7' width='40' height='40' fill='%23daf0ff'/%3E%3Crect x='6' y='12' width='28' height='16' rx='4' fill='%23b8e3f8'/%3E%3C/svg%3E`;

function debounce(fn, ms){ let t; return (...a) => { clearTimeout(t); t = setTimeout(()=>fn(...a), ms); }; }

function fuzzyScore(hay, needle){
  hay = hay.toLowerCase(); needle = needle.toLowerCase();
  if(!needle) return 1;
  if(hay.includes(needle)) return 100 + needle.length * 2;
  let j = 0, s = 0;
  for(let i = 0; i < hay.length && j < needle.length; i++) if(hay[i] === needle[j]){ s++; j++; }
  return j === needle.length ? s : 0;
}

function isNew(added){
  if(!added) return false;
  const diff = (Date.now() - new Date(added + 'T00:00').getTime()) / 86400000;
  return diff >= 0 && diff <= CONFIG.NEW_BADGE_DAYS;
}

/* â”€â”€ SHA-256 helper â”€â”€ */
async function sha256(str) {
  const buf  = new TextEncoder().encode(str);
  const hash = await crypto.subtle.digest('SHA-256', buf);
  return Array.from(new Uint8Array(hash))
    .map(b => b.toString(16).padStart(2, '0'))
    .join('');
}

/* â”€â”€ Rate limiting helpers (session-scoped) â”€â”€ */
function getLockoutUntil(){ return parseInt(sessionStorage.getItem('gg_lock_until') || '0'); }
function getAttempts()     { return parseInt(sessionStorage.getItem('gg_attempts')   || '0'); }
function resetAttempts()   { sessionStorage.removeItem('gg_attempts'); sessionStorage.removeItem('gg_lock_until'); }
function recordBadAttempt(){
  const n = getAttempts() + 1;
  sessionStorage.setItem('gg_attempts', n);
  if(n >= CONFIG.MAX_ATTEMPTS) sessionStorage.setItem('gg_lock_until', Date.now() + CONFIG.LOCKOUT_MS);
  return n;
}

/* â”€â”€ Favicon lazy loader â”€â”€ */
const favCache = new Set();
const faviconObserver = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if(!entry.isIntersecting) return;
    const img = entry.target;
    const src = img.dataset.favSrc;
    if(!src) return;
    faviconObserver.unobserve(img);
    if(favCache.has(src)){ img.src = src; return; }
    const probe = new Image();
    probe.onload  = () => { favCache.add(src); img.src = src; };
    probe.onerror = () => {};
    probe.src = src;
  });
}, { rootMargin: '200px' });

/* â”€â”€ Toast â”€â”€ */
let toastTimer;
function showToast(text, ms=2200){
  $('toastMsg').textContent = text;
  $('toast').classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => $('toast').classList.remove('show'), ms);
}

/* â”€â”€ Persistent storage â”€â”€ */
const Store = {
  get(k, fallback=null){ try{ const v=localStorage.getItem(k); return v!=null?JSON.parse(v):fallback; }catch{ return fallback; } },
  set(k, v){ try{ localStorage.setItem(k,JSON.stringify(v)); }catch{} },
};

/* ======================================================================
   STATE
   ====================================================================== */
let currentQuery = '';
let currentCat   = 'all';
let currentSort  = 'default';
let currentView  = Store.get('gg_view','grid');
let isCompact    = Store.get('gg_compact',false);
let isDark       = Store.get('gg_dark',false);
let favourites   = new Set(Store.get('gg_favs',[]));
let recentLinks  = Store.get('gg_recent',[]);

/* ======================================================================
   THEMING
   ====================================================================== */
function applyTheme(){
  document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
  $('themeBtn').setAttribute('aria-pressed', String(isDark));
  const icon = $('themeIcon');
  if(isDark){
    icon.setAttribute('d','M12 3v1m0 16v1m9-9h-1M4 12H3m15.36-6.36l-.7.7M6.34 17.66l-.7.7m12.02.02l-.7-.7M6.34 6.34l-.7-.7M17 12a5 5 0 1 1-10 0 5 5 0 0 1 10 0z');
    icon.setAttribute('fill','none');
    icon.setAttribute('stroke','var(--accent)');
    icon.setAttribute('stroke-width','1.7');
    icon.setAttribute('stroke-linecap','round');
  } else {
    icon.setAttribute('d','M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z');
    icon.setAttribute('fill','var(--accent)');
    icon.removeAttribute('stroke');
    icon.removeAttribute('stroke-width');
    icon.removeAttribute('stroke-linecap');
  }
}

function applyCompact(){
  document.documentElement.setAttribute('data-compact', String(isCompact));
  $('compactBtn').setAttribute('aria-pressed', String(isCompact));
}

function applyView(){
  $('app').setAttribute('data-view', currentView);
  $('viewBtn').setAttribute('aria-pressed', String(currentView === 'list'));
}

$('themeBtn').addEventListener('click', () => {
  isDark = !isDark; Store.set('gg_dark', isDark); applyTheme(); showToast(isDark ? 'ğŸŒ™ Dark mode on' : 'â˜€ï¸ Light mode on');
});
$('compactBtn').addEventListener('click', () => {
  isCompact = !isCompact; Store.set('gg_compact', isCompact); applyCompact(); render();
});
$('viewBtn').addEventListener('click', () => {
  currentView = currentView === 'grid' ? 'list' : 'grid';
  Store.set('gg_view', currentView); applyView();
});

/* ======================================================================
   DAILY FEATURED GAME
   ====================================================================== */
function setupFeatured(){
  const withDates = LINKS.filter(l => l.added);
  const game = withDates.length
    ? withDates.reduce((a,b) => new Date(a.added) > new Date(b.added) ? a : b)
    : LINKS[0];

  const emojis = { io:'ğŸ•¹ï¸', hub:'ğŸ—‚ï¸', classic:'ğŸ‘¾', fun:'ğŸ‰', retro:'ğŸ’¾', edu:'ğŸ“š', sim:'ğŸŒ' };
  $('featuredIcon').textContent = emojis[game.cat] || 'ğŸ®';
  $('featuredName').textContent = game.name;
  $('featuredHost').textContent = game.added
    ? `Added ${new Date(game.added + 'T00:00').toLocaleDateString('en-IE',{day:'numeric',month:'long',year:'numeric'})}`
    : hostOf(game.url);
  $('featuredLink').href = game.url;

  const label = $('featuredBanner').querySelector('.featured-label');
  if(label) label.textContent = 'âœ¨ Newest Addition';
}

/* ======================================================================
   RECENTLY VISITED
   ====================================================================== */
function trackVisit(url){
  recentLinks = [url, ...recentLinks.filter(u => u !== url)].slice(0, CONFIG.RECENT_MAX);
  Store.set('gg_recent', recentLinks);
}

function renderRecent(){
  const strip = $('recentStrip');
  const section = $('recentSection');
  if(!recentLinks.length){ section.style.display='none'; return; }
  section.style.display = '';
  strip.innerHTML = '';
  recentLinks.forEach(url => {
    const link = LINKS.find(l => l.url === url);
    if(!link) return;
    const a = document.createElement('a');
    a.className = 'recent-chip';
    a.href = url; a.target = '_blank'; a.rel = 'noopener noreferrer';
    a.setAttribute('aria-label', link.name);
    a.addEventListener('click', () => trackVisit(url));
    const img = document.createElement('img');
    img.src = favUrl(url); img.alt = ''; img.loading = 'lazy';
    img.onerror = () => { img.style.display='none'; };
    a.appendChild(img);
    a.appendChild(document.createTextNode(link.name));
    strip.appendChild(a);
  });
}

/* ======================================================================
   FILTER BUTTONS
   ====================================================================== */
function buildFilters(){
  const bar = $('filterBar');
  const cats = Object.keys(CAT_LABELS);
  cats.forEach(cat => {
    const btn = document.createElement('button');
    btn.className = 'filter-btn' + (cat==='all'?' active':'');
    btn.textContent = CAT_LABELS[cat];
    btn.dataset.cat = cat;
    btn.setAttribute('aria-pressed', String(cat==='all'));
    btn.addEventListener('click', () => {
      currentCat = cat;
      bar.querySelectorAll('.filter-btn').forEach(b => {
        b.classList.toggle('active', b.dataset.cat===cat);
        b.setAttribute('aria-pressed', String(b.dataset.cat===cat));
      });
      render();
    });
    bar.appendChild(btn);
  });
}

/* ======================================================================
   SORT & FILTER LOGIC
   ====================================================================== */
function getFiltered(){
  let list = [...LINKS];

  if(currentCat !== 'all') list = list.filter(l => l.cat === currentCat);

  if(currentQuery.trim()){
    const q = currentQuery.trim();
    list = list
      .map(l => ({ l, s: Math.max(fuzzyScore(l.name,q), fuzzyScore(hostOf(l.url),q)) }))
      .filter(x => x.s > 0)
      .sort((a,b) => b.s - a.s)
      .map(x => x.l);
    return list;
  }

  if(currentSort === 'az') list.sort((a,b) => a.name.localeCompare(b.name));
  else if(currentSort === 'za') list.sort((a,b) => b.name.localeCompare(a.name));
  else if(currentSort === 'favs'){
    list.sort((a,b) => {
      const af = favourites.has(a.url) ? 0 : 1;
      const bf = favourites.has(b.url) ? 0 : 1;
      return af - bf;
    });
  }

  return list;
}

/* ======================================================================
   RENDER
   ====================================================================== */
const grid  = $('linkGrid');
const empty = $('emptyState');

function render(){
  const list  = getFiltered();
  const total = list.length;

  $('resultsCount').textContent = total === LINKS.length
    ? `${total} games`
    : `${total} of ${LINKS.length} games`;
  $('activeFilterLabel').textContent = currentCat !== 'all'
    ? `Showing: ${CAT_LABELS[currentCat] || currentCat}`
    : '';

  if(!total){ grid.innerHTML=''; empty.classList.add('show'); return; }
  empty.classList.remove('show');

  faviconObserver.disconnect();

  const frag = document.createDocumentFragment();
  list.forEach((l, i) => {
    const isFav = favourites.has(l.url);

    const a = document.createElement('a');
    a.className = 'tile' + (isFav?' fav-tile':'');
    a.href = l.url; a.target='_blank'; a.rel='noopener noreferrer';
    a.setAttribute('role','listitem');
    a.setAttribute('aria-label', l.name);
    a.style.animationDelay = `${Math.min(i*16,280)}ms`;

    a.addEventListener('click', () => { trackVisit(l.url); renderRecent(); });

    const iconDiv = document.createElement('div'); iconDiv.className='tile-icon';
    const img = document.createElement('img'); img.alt=''; img.src=XP_FALLBACK;
    img.dataset.favSrc = favUrl(l.url);
    img.onerror = () => { img.onerror=null; img.src=XP_FALLBACK; };
    faviconObserver.observe(img);
    iconDiv.appendChild(img);

    const body = document.createElement('div'); body.className='tile-body';
    const nameEl = document.createElement('div'); nameEl.className='tile-name'; nameEl.textContent=l.name;
    const hostEl = document.createElement('div'); hostEl.className='tile-host'; hostEl.textContent=hostOf(l.url);
    body.appendChild(nameEl); body.appendChild(hostEl);

    const favBtn = document.createElement('button');
    favBtn.className = 'tile-fav' + (isFav?' active':'');
    favBtn.title = isFav ? 'Remove from favourites' : 'Add to favourites';
    favBtn.setAttribute('aria-label', isFav ? `Remove ${l.name} from favourites` : `Favourite ${l.name}`);
    favBtn.innerHTML = `<svg viewBox="0 0 24 24" fill="none"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" stroke="${isFav?'none':'var(--text-soft)'}" stroke-width="1.5" fill="${isFav?'var(--star-active)':'none'}"/></svg>`;
    favBtn.addEventListener('click', e => {
      e.preventDefault(); e.stopPropagation();
      if(favourites.has(l.url)){ favourites.delete(l.url); showToast(`Removed from favourites`); }
      else{ favourites.add(l.url); SFX.fav(); showToast(`â­ Added to favourites`); }
      Store.set('gg_favs', [...favourites]);
      render();
    });

    const reportBtn = document.createElement('button');
    reportBtn.className = 'tile-report';
    reportBtn.title = 'Report broken link';
    reportBtn.setAttribute('aria-label', `Report broken link: ${l.name}`);
    reportBtn.innerHTML = `<svg width="10" height="10" viewBox="0 0 24 24" fill="none"><path d="M12 8v5" stroke="var(--danger)" stroke-width="2" stroke-linecap="round"/><circle cx="12" cy="16.5" r="1" fill="var(--danger)"/><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" stroke="var(--danger)" stroke-width="1.5" stroke-linejoin="round"/></svg> Report`;
    reportBtn.addEventListener('click', e => {
      e.preventDefault(); e.stopPropagation();
      const title = encodeURIComponent(`Broken link: ${l.name}`);
      const body  = encodeURIComponent(`**Link:** [${l.name}](${l.url})\n**Issue:** This link appears to be broken or unavailable.\n\n_Reported via the Game Gallery._`);
      window.open(`https://github.com/${CONFIG.GITHUB_REPO}/issues/new?title=${title}&body=${body}`, '_blank', 'noopener');
    });

    if(isNew(l.added)){
      const badge = document.createElement('div');
      badge.className='tile-badge-new'; badge.textContent='NEW';
      a.appendChild(badge);
    }

    a.appendChild(iconDiv); a.appendChild(body); a.appendChild(favBtn); a.appendChild(reportBtn);
    frag.appendChild(a);
  });

  grid.innerHTML = '';
  grid.appendChild(frag);
}

/* ======================================================================
   SEARCH
   ====================================================================== */
const searchInput = $('searchInput');
searchInput.addEventListener('input', debounce(e => { currentQuery=e.target.value; render(); }, 100));
document.addEventListener('keydown', e => {
  if(e.key==='/' && document.activeElement!==searchInput && !document.body.classList.contains('locked')){
    e.preventDefault(); searchInput.focus(); searchInput.select();
  }
  if(e.key==='Escape' && document.activeElement===searchInput){
    searchInput.value=''; currentQuery=''; render();
  }
});

$('sortSelect').addEventListener('change', e => { currentSort=e.target.value; render(); });

grid.addEventListener('keydown', e => {
  const items = [...grid.querySelectorAll('.tile')];
  const idx   = items.indexOf(document.activeElement);
  if(idx===-1) return;
  const cols = Math.max(1, Math.round(grid.clientWidth / 214));
  const map  = { ArrowRight:1, ArrowLeft:-1, ArrowDown:cols, ArrowUp:-cols };
  if(map[e.key] !== undefined){
    e.preventDefault();
    items[Math.min(Math.max(idx+map[e.key],0), items.length-1)]?.focus();
  }
});

/* ======================================================================
   RANDOM GAME SPINNER
   ====================================================================== */
function pickRandom(){
  const list = getFiltered().length ? getFiltered() : LINKS;
  return list[Math.floor(Math.random() * list.length)];
}

function openSpinner(){
  const game = pickRandom();
  $('spinnerName').textContent = game.name;
  $('spinnerHost').textContent = hostOf(game.url);
  $('spinnerGo').href = game.url;
  $('spinnerOverlay').classList.add('open');
}

$('randomBtn').addEventListener('click', () => { SFX.random(); openSpinner(); });
$('spinnerAgain').addEventListener('click', () => {
  $('spinnerName').textContent='â€¦';
  setTimeout(() => {
    const g = pickRandom();
    $('spinnerName').textContent = g.name;
    $('spinnerHost').textContent = hostOf(g.url);
    $('spinnerGo').href = g.url;
  }, 200);
});
$('spinnerClose').addEventListener('click', () => $('spinnerOverlay').classList.remove('open'));
$('spinnerOverlay').addEventListener('click', e => { if(e.target===$('spinnerOverlay')) $('spinnerOverlay').classList.remove('open'); });

/* ======================================================================
   AUDIO
   ====================================================================== */
const audioBtn    = $('audioBtn');
const speakerWaves= $('speakerWaves');
const muteX       = $('muteX');
let audio   = null;
let playing = false;

function createAudio(){
  if(audio) return;
  audio = new Audio(CONFIG.AUDIO_SRC);
  audio.loop=true; audio.volume=CONFIG.AUDIO_VOLUME; audio.preload='auto';
  audio.addEventListener('play',  () => { playing=true;  muteX.style.display='none'; speakerWaves.style.display=''; audioBtn.setAttribute('aria-pressed','true');  showToast('â™ª Music playing'); });
  audio.addEventListener('pause', () => { playing=false; muteX.style.display='';     speakerWaves.style.display='none'; audioBtn.setAttribute('aria-pressed','false'); showToast('Music paused'); });
  audio.addEventListener('error', () => { showToast('Music.mp3 not found â€” drop it in your repo.',4000); audio=null; playing=false; });
}

audioBtn.addEventListener('click', () => {
  createAudio();
  if(!audio) return;
  playing ? audio.pause() : audio.play().catch(() => showToast('Tap play again to start music.',3000));
});
function tryAutoplay(){ createAudio(); if(audio) audio.play().catch(()=>{}); }

/* ======================================================================
   LOCK â€” SHA-256 hashed password + rate limiting
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   The plain-text access code is NEVER stored in this file.

   Rate limiting: after MAX_ATTEMPTS wrong guesses the input locks for
   LOCKOUT_MS milliseconds (tracked in sessionStorage, resets on tab close).
   ====================================================================== */
const overlay   = $('lockOverlay');
const passInput = $('passInput');
const errMsg    = $('errMsg');
const errText   = $('errText');

let lockCountdown = null;

function startLockoutCountdown(){
  const btn = $('passBtn');
  if(lockCountdown) clearInterval(lockCountdown);
  lockCountdown = setInterval(() => {
    const remaining = Math.ceil((getLockoutUntil() - Date.now()) / 1000);
    if(remaining <= 0){
      clearInterval(lockCountdown); lockCountdown = null;
      resetAttempts();
      btn.disabled = false;
      btn.textContent = 'UNLOCK';
      errText.textContent = 'You can try again now.';
      passInput.disabled = false;
      passInput.focus();
    } else {
      btn.disabled = true;
      btn.textContent = `Wait ${remaining}s`;
      passInput.disabled = true;
      errMsg.classList.add('show');
      errText.textContent = `Too many attempts â€” wait ${remaining}s.`;
    }
  }, 250);
}

function unlock(remember=true){
  overlay.classList.add('hiding');
  setTimeout(() => overlay.style.display='none', 420);
  document.body.classList.remove('locked');
  errMsg.classList.remove('show');
  if(remember){ try{ sessionStorage.setItem('gg_unlocked','1'); }catch(_){} }
  setTimeout(() => searchInput.focus(), 80);
  tryAutoplay();
  SFX.unlock();
  showToast('Welcome to the Gallery âœ¦', 2500);
}

async function tryUnlock(){
  // Check if still locked out
  const lockUntil = getLockoutUntil();
  if(lockUntil && Date.now() < lockUntil){ startLockoutCountdown(); return; }

  const val = (passInput.value || '').trim();
  passInput.value = ''; // clear immediately â€” value never sits in DOM

  if(!val) return;

  const hash = await sha256(val);

  if(hash === CONFIG.LOCK_HASH){
    resetAttempts();
    unlock(true);
  } else {
    const attempts = recordBadAttempt();
    const newLock  = getLockoutUntil();
    SFX.error();
    overlay.animate(
      [{transform:'translateX(-6px)'},{transform:'translateX(6px)'},{transform:'none'}],
      {duration:260}
    );
    if(newLock && Date.now() < newLock){
      startLockoutCountdown();
    } else {
      const left = CONFIG.MAX_ATTEMPTS - attempts;
      errMsg.classList.add('show');
      errText.textContent = left > 0
        ? `Incorrect code â€” ${left} attempt${left===1?'':'s'} remaining.`
        : 'Too many attempts.';
      passInput.focus();
    }
  }
}

$('passBtn').addEventListener('click', tryUnlock);
passInput.addEventListener('keydown', e => {
  if(e.key === 'Enter'){ e.preventDefault(); tryUnlock(); }
  if(e.key === 'Escape'){ passInput.value = ''; errMsg.classList.remove('show'); }
});

document.addEventListener('focusin', e => {
  if(document.body.classList.contains('locked') && !overlay.contains(e.target)){
    e.stopPropagation(); passInput.focus();
  }
});

/* ======================================================================
   SEASONAL THEMES
   ====================================================================== */
const SEASONS = {
  spring: { months:[2,3,4],  emoji:'ğŸŒ¸', label:'Spring', particles:'blossoms', chars:['ğŸŒ¸','ğŸŒº','ğŸŒ¼','ğŸª·'] },
  summer: { months:[5,6,7],  emoji:'â˜€ï¸', label:'Summer', particles:null,       chars:[] },
  autumn: { months:[8,9,10], emoji:'ğŸ‚', label:'Autumn', particles:'leaves',   chars:['ğŸ‚','ğŸ','ğŸŒ¿','ğŸƒ'] },
  winter: { months:[11,0,1], emoji:'â„ï¸', label:'Winter', particles:'snowflakes',chars:['â„','âœ¦','*','Â·','â…'] },
};

function getSeason(){
  const m = new Date().getMonth();
  return Object.entries(SEASONS).find(([,v]) => v.months.includes(m)) || ['summer', SEASONS.summer];
}

function setupSeason(){
  const [name, data] = getSeason();
  document.documentElement.setAttribute('data-season', name);

  const pill = $('seasonPill');
  pill.textContent = `${data.emoji} ${data.label}`;

  if(data.particles && data.chars.length){
    const container = $(data.particles);
    const count = name === 'winter' ? 22 : 14;
    for(let i = 0; i < count; i++){
      const el = document.createElement('div');
      el.className = data.particles.slice(0,-1);
      el.textContent = data.chars[Math.floor(Math.random()*data.chars.length)];
      el.style.left     = `${Math.random()*100}%`;
      el.style.fontSize = `${0.7 + Math.random()*0.8}em`;
      el.style.animationDuration  = `${6 + Math.random()*10}s`;
      el.style.animationDelay     = `${-Math.random()*12}s`;
      container.appendChild(el);
    }
  }

  if(name === 'summer') $('seasonPill').style.display = 'none';
}

/* ======================================================================
   SOUND EFFECTS
   ====================================================================== */
const SFX = (() => {
  let ctx = null;
  const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion:reduce)').matches;

  function getCtx(){
    if(!ctx) ctx = new (window.AudioContext || window.webkitAudioContext)();
    return ctx;
  }

  function tone(freq, type='sine', vol=0.08, duration=0.12, fadeOut=true){
    if(prefersReducedMotion) return;
    try{
      const c  = getCtx();
      const o  = c.createOscillator();
      const g  = c.createGain();
      o.connect(g); g.connect(c.destination);
      o.type      = type;
      o.frequency.setValueAtTime(freq, c.currentTime);
      g.gain.setValueAtTime(vol, c.currentTime);
      if(fadeOut) g.gain.exponentialRampToValueAtTime(0.001, c.currentTime + duration);
      o.start(c.currentTime);
      o.stop(c.currentTime + duration);
    } catch(e){}
  }

  return {
    hover()  { tone(880, 'sine',     0.04, 0.08); },
    click()  { tone(660, 'triangle', 0.07, 0.10); },
    fav()    { tone(1046,'sine',     0.06, 0.15); setTimeout(()=>tone(1318,'sine',0.05,0.12),80); },
    unlock() { [523,659,784,1046].forEach((f,i) => setTimeout(()=>tone(f,'sine',0.06,0.18),i*70)); },
    error()  { tone(220, 'sawtooth', 0.05, 0.18); },
    random() { tone(784, 'sine',     0.06, 0.10); setTimeout(()=>tone(1046,'sine',0.05,0.10),90); },
  };
})();

document.addEventListener('mouseover', e => { if(e.target.closest('.tile')) SFX.hover(); });
document.addEventListener('mousedown', e => {
  if(e.target.closest('.tile') || e.target.closest('button') || e.target.closest('a')) SFX.click();
});

/* ======================================================================
   CUSTOM CURSOR
   ====================================================================== */
(function initCursor(){
  const dot  = $('cursorDot');
  const ring = $('cursorRing');
  let rx=0,ry=0, tx=0,ty=0;

  document.addEventListener('mousemove', e => {
    tx = e.clientX; ty = e.clientY;
    dot.style.left = tx+'px'; dot.style.top = ty+'px';
  });

  (function loop(){
    rx += (tx-rx)*0.14;
    ry += (ty-ry)*0.14;
    ring.style.left = rx+'px'; ring.style.top = ry+'px';
    requestAnimationFrame(loop);
  })();

  document.addEventListener('mouseover', e => {
    const hoverable = e.target.closest('a,button,.tile,.filter-btn,.icon-btn,.contribute-btn,.unlock-btn,.recent-chip');
    document.body.classList.toggle('cursor-hover', !!hoverable);
  });

  document.addEventListener('mousedown', () => {
    document.body.classList.add('cursor-click');
    setTimeout(()=>document.body.classList.remove('cursor-click'), 200);
  });

  document.addEventListener('mouseleave', () => { dot.style.opacity='0'; ring.style.opacity='0'; });
  document.addEventListener('mouseenter', () => { dot.style.opacity='1'; ring.style.opacity='1'; });
})();

/* ======================================================================
   KONAMI CODE EASTER EGG
   ====================================================================== */
const KONAMI = ['ArrowUp','ArrowUp','ArrowDown','ArrowDown','ArrowLeft','ArrowRight','ArrowLeft','ArrowRight','b','a'];
let konamiIdx = 0;
document.addEventListener('keydown', e => {
  if(e.key === KONAMI[konamiIdx]){ konamiIdx++; if(konamiIdx===KONAMI.length){ konamiIdx=0; konamiEgg(); } }
  else konamiIdx=0;
});
function konamiEgg(){
  showToast('ğŸ® +30 lives! (just kidding)', 3000);
  document.querySelectorAll('.tile').forEach((t,i) => {
    setTimeout(()=>{
      t.style.transition='transform .4s cubic-bezier(.2,.9,.3,1)';
      t.style.transform='rotate(360deg) scale(0.95)';
      setTimeout(()=>{ t.style.transform=''; }, 420);
    }, i*18);
  });
}

/* ======================================================================
   INIT
   ====================================================================== */
window.addEventListener('DOMContentLoaded', () => {
  applyTheme();
  applyCompact();
  applyView();
  setupSeason();
  buildFilters();
  setupFeatured();
  renderRecent();
  render();

  // Check if already unlocked this session
  try{
    if(sessionStorage.getItem('gg_unlocked')==='1'){
      unlock(false); tryAutoplay();
    } else {
      // Check for leftover lockout on page load
      const lockUntil = getLockoutUntil();
      if(lockUntil && Date.now() < lockUntil) startLockoutCountdown();
      passInput.focus();
    }
  } catch(_){ passInput.focus(); }
});
</script>
</body>
</html>
